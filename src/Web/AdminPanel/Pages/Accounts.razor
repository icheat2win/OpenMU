@page "/accounts"
@using MUnique.OpenMU.Web.AdminPanel.Services
@using MUnique.OpenMU.DataModel.Entities;
@using MUnique.OpenMU.Persistence;

@inject AccountService _accountService;

<PageTitle>OpenMU: Accounts</PageTitle>
<Breadcrumb IsFirstFromRoot="true" Caption="Accounts" />

<div class="page-header">
    <h1>👤 Account Management</h1>
    <p class="text-muted">Manage player accounts and user credentials</p>
</div>

<div class="accounts-page">
    <ModernCard Title="Accounts" Icon="📋" CssClass="accounts-card">
        <HeaderActions>
            <button type="button" class="btn btn-sm btn-success" @onclick="@this._accountService.CreateNewInModalDialogAsync">
                <span class="btn-icon">➕</span> Create Account
            </button>
        </HeaderActions>
        <ChildContent>
            <DataTable TItem=@Account CssClass="modern-table">
                <TableHeader>
                    <th class="col-1">Login Name</th>
                    <th class="col-1">State</th>
                    <th class="col-2">E-Mail</th>
                    <th class="col-2">Action</th>
                </TableHeader>
                <ItemTemplate Context="item">
                    <td>
                        <span class="account-name">@item.LoginName</span>
                    </td>
                    <td>
                        <StatBadge Value="@item.State.ToString()" Color="@GetAccountStateBadgeColor(item.State)" />
                    </td>
                    <td>
                        <span class="account-email">@item.EMail</span>
                    </td>
                    <td>
                        <NavLink href="@($"edit-account/{item.GetId()}/{typeof(Account).FullName}/{item.GetId()}")" class="btn btn-sm btn-primary">
                            ✏️ Edit
                        </NavLink>
                    </td>
                </ItemTemplate>
            </DataTable>
        </ChildContent>
    </ModernCard>
</div>

@code {
    private string GetAccountStateBadgeColor(AccountState state)
    {
        return state switch
        {
            AccountState.Normal => "success",
            AccountState.Banned => "danger",
            AccountState.TemporarilyBanned => "warning",
            _ => "default"
        };
    }
}
