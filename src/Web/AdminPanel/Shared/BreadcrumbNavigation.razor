@using MUnique.OpenMU.Web.AdminPanel.Services

@implements IDisposable

@inject NavigationHistory History;

<div class="flex items-center gap-2" role="group" aria-label="Navigation arrows">
  @if (this.History.CanGoBackward)
  {
    <button class="px-3 py-1.5 text-sm font-medium text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors"
      aria-disabled="False"
      title="Previous"
      aria-label="Previous"
      @onclick="() => this.History.GoBackward()">
      <span class="oi oi-arrow-circle-left"></span>
    </button>
  }
  else
  {
    <button class="px-3 py-1.5 text-sm font-medium text-slate-400 dark:text-slate-600 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg cursor-not-allowed"
            aria-disabled="True"
            title="Previous"
            aria-label="Previous"
            disabled>
      <span class="oi oi-arrow-circle-left"></span>
    </button>
  }

  @if (this.History.CanGoForward)
  {
    <button class="px-3 py-1.5 text-sm font-medium text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors"
          aria-disabled="False"
          title="Next"
          aria-label="Next"
          @onclick="() => this.History.GoForward()">
      <span class="oi oi-arrow-circle-right"></span>
    </button>
  }
  else
  {
    <button class="px-3 py-1.5 text-sm font-medium text-slate-400 dark:text-slate-600 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg cursor-not-allowed"
            aria-disabled="True"
            title="Next"
            aria-label="Next"
            disabled>
      <span class="oi oi-arrow-circle-right"></span>
    </button>
  }
</div>
<nav aria-label="breadcrumb" class="ml-4">
  <ol class="flex items-center gap-2 text-sm">

  @foreach (var item in this.History.Previous)
  {
    <li class="flex items-center gap-2">
    <a href="#" @onclick="() => this.History.JumpTo(item)" class="text-slate-600 dark:text-slate-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">@item.Title</a>
    <span class="text-slate-400 dark:text-slate-600">/</span>
    </li>
  }
  <li class="text-slate-900 dark:text-white font-medium" aria-current="page">@this.History.Current?.Title</li>
  
  @foreach (var item in this.History.Next)
  {
    <li class="flex items-center gap-2">
      <span class="text-slate-400 dark:text-slate-600">/</span>
      <a href="#" @onclick="() => this.History.JumpTo(item)" class="text-slate-600 dark:text-slate-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">@item.Title</a>
    </li>
  }
  </ol>
</nav>

@code {

  public void Dispose()
  {
    this.History.HistoryChanged -= this.OnHistoryChanged;
  }

  protected override void OnInitialized()
  {
    base.OnInitialized();
    this.History.HistoryChanged -= this.OnHistoryChanged;
    this.History.HistoryChanged += this.OnHistoryChanged;
  }

  private void OnHistoryChanged(object? sender, EventArgs e)
  {
    this.StateHasChanged();
  }

}
